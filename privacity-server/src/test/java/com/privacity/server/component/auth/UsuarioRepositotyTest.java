package com.privacity.server.component.auth;


import java.lang.reflect.Modifier;
import java.security.KeyFactory;
import java.security.PrivateKey;
import java.security.spec.PKCS8EncodedKeySpec;
import java.time.LocalDateTime;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.privacity.common.adapters.LocalDateAdapter;
import com.privacity.common.dto.AESDTO;
import com.privacity.commonback.common.utils.AESToUse;
import com.privacity.core.repository.UsuarioRepository;

import lombok.extern.slf4j.Slf4j;

//@SpringBootTest
@Slf4j
class UsuarioRepositotyTest {

	@Autowired
	private UsuarioRepository r;
	@Autowired
	//private EncryptKeysRepository  k;
	//@Autowired
	//private UsuarioPasswordRepository rp;
//	
//	//@Test
//	void registerUser() throws Exception {
////		try {
////
////
////			Usuario u = new Usuario();
////			//u.setIdUser(55228L);
////			u.setNickname("fewfew");
////			u.setUsername("99f9");
////			
////			
////			//
////			
////			u.setUsuarioPassword(new UsuarioPassword(u,"fewfwef"));
////			u.getUsuarioPassword().setPassword("21r2");
////			//r.save(u);
////			
//////			u.getUsuarioPassword().setUsuario(u);
////
//////			rp.save(
//////					u.getUsuarioPassword());
////			r.save(u);
////		} catch (Exception e) {
////			// TODO Auto-generated catch block
////			e.printStackTrace();
////		}
//	}
//	
	@Test
	void registerUser() throws Exception {
		try {
			
			/*
			 * 636





			 */
			
			Gson g = new GsonBuilder()
			.registerTypeAdapter(LocalDateTime.class, new LocalDateAdapter())
			//.excludeFieldsWithoutExposeAnnotation()
			.excludeFieldsWithModifiers(Modifier.STATIC)
			.serializeNulls()
			.create();
			
			String pk ="[-35,97,-65,-68,-113,-103,-48,-93,-38,-31,-72,-63,-127,-25,-53,91,72,99,-8,-60,-60,-11,-103,121,-91,98,-41,17,90,-55,-116,26,14,122,62,76,-80,-17,-102,-96,16,-15,-19,100,112,65,30,-115,-52,32,-93,15,59,-100,-37,54,-74,-39,84,3,46,-113,17,97,121,-76,-19,18,-43,120,-108,42,-11,-105,-106,25,57,80,2,-39,-96,-88,-91,-40,-125,111,-67,19,96,115,-68,55,-118,28,-8,122,12,-58,116,-115,-23,102,82,-50,19,-120,-123,54,49,101,61,52,-4,-100,-98,-40,-78,-15,-57,-20,116,101,74,-10,15,10,53,73,16,-128,-81,-106,-38,-45,-13,115,-14,25,49,-82,119,7,-104,104,-87,39,-97,-92,-4,-94,-76,-47,-31,69,33,58,51,118,-77,-42,33,73,-52,48,14,87,58,-47,-56,-64,-61,106,-18,-91,-44,96,-59,9,80,-57,-98,-5,-9,24,80,-17,-61,28,-10,-103,49,121,-33,100,32,-17,1,64,-111,27,49,18,-17,-56,-8,-1,-109,-75,79,-79,-62,92,-76,18,16,-39,-74,-79,-127,94,106,-99,-123,121,-123,115,67,54,-34,44,-99,-11,-102,46,115,73,-49,101,-45,111,116,15,-127,53,76,-112,5,33,-83,-128,-108,-94,-124,-25,-105,44,120,119,52,7,112,-54,-63,-67,-91,124,-39,-37,62,-19,-91,-117,-20,113,2,56,97,103,65,43,-87,21,-86,-71,113,-127,-117,-41,-92,-29,124,95,126,46,68,50,28,-18,86,120,-36,-30,-45,-102,77,30,-16,1,35,115,85,34,-73,109,91,-17,63,50,-34,8,42,-25,85,50,-15,41,69,-111,-79,4,106,101,-32,-97,82,-61,54,68,-60,54,69,65,-15,-12,-36,-110,-124,11,-48,-60,-108,61,-83,-50,-53,5,86,-40,89,-43,-69,8,-91,68,-83,97,-35,28,11,-42,82,-92,-22,-92,16,-78,44,-32,-44,53,47,65,123,111,127,-66,48,-45,-110,-72,17,-63,-74,-75,-123,74,-31,-109,-15,-65,51,-118,-11,18,92,34,47,-74,-123,-124,-67,25,-68,-34,56,-95,-77,-8,-68,-1,-46,-70,-104,8,-30,-66,107,-49,35,-54,-93,-70,91,96,-72,57,80,-61,51,-37,75,48,-26,-89,-33,2,-13,-122,107,-58,-19,-34,103,-39,-88,-6,-18,-95,32,-79,79,53,-28,-70,20,-3,123,-72,-108,-78,-61,-103,17,20,91,41,-91,-111,-7,123,-109,-52,-46,13,35,50,-95,16,116,-15,90,15,105,-3,76,37,-102,76,44,104,-12,-93,25,123,-52,-69,-123,-5,-82,61,-24,-61,-116,-5,67,32,-95,100,115,-71,-43,51,-95,121,73,-94,-102,-121,-44,111,-67,-17,-118,-85,-112,2,108,54,25,13,-42,-125,-15,33,19,-7,-56,-39,81,50,-89,-43,-122,-78,-20,15,-22,91,-42,-123,-102,107,118,-35,-37,-87,-85,-68,54,-24,41,-86,-82,-17,125,37,39,19,-113,-3,-47,114,-40,-4,86,-57,124,-8,64,24,54,116,-41,125,-114,6,-24,83,-21,-24,-20,5,12,-112,-120,24,41,44,-84,-123,-126,93,-26,3,109,50,97,41,-45,-58,-12,27,-97,95,-15,3,27,37,-23,43,74,106,91,-30,-61,-24,41,-111,97,-120,53,127,-54,-67,-68,63,-82,-50,92,21,-86,-70,-79,0,-16,-43,112,-121,50,15,82,114,125,-15,-47,-13,106,77,56,-52,-21,118,101,9,-94,-33,92,40,125,19,15,-90,-62,91,-113,98,-24,31,93,9,101,18,1,68,4,-54,50,-52,-74,70,-33,73,-122,75,-117,125,117,-46,22,83,32,-32,-19,101,71,22,122,86,123,-83,-114,127,-65,61,90,0,90,87,80,-30,-62,30,-52,55,-74,-34,-75,101,18,-72,-99,-7,125,-100,118,-66,18,11,-46,98,-124,-96,15,8,-54,-111,-127,115,112,-67,30,-8,36,-127,73,-107,-120,-112,30,-77,-97,47,-91,-70,-60,80,-101,-44,21,-80,110,33,94,-116,113,-115,16,103,-128,114,-3,54,86,71,42,-112,117,-6,125,-38,43,24,-55,-119,44,-11,-26,57,5,-78,-38,119,66,22,93,-64,39,63,23,104,19,-37,116,56,-41,-37,103,105,37,109,49,-33,69,33,-72,23,-58,20,27,5,-17,-65,120,13,-72,-83,97,-97,-67,-92,-86,94,-105,69,101,96,-108,-115,-40,-114,116,89,-28,53,-125,65,-20,96,-39,-49,-94,78,-47,-109,43,71,-30,81,79,45,-42,7,3,30,122,-110,-91,-53,-48,-59,-104,-73,32,-102,20,-107,-13,5,-49,82,-107,33,31,-59,83,98,-59,36,-121,-38,-70,21,-90,112,72,1,22,-12,20,-96,-55,72,101,-52,111,60,-110,-47,58,67,-21,-63,19,-87,76,12,-41,-81,-92,20,-86,-119,-40,4,16,119,102,-117,35,42,-41,19,-24,-106,55,-37,-37,-13,97,-38,-5,-87,-118,106,-51,57,-98,95,98,126,119,-119,38,-5,75,49,50,-106,10,-31,112,127,-23,82,-106,117,-106,-72,-35,85,6,105,35,-120,36,-83,-43,71,-92,37,-32,-87,45,-105,30,-50,18,-46,-62,101,72,73,64,102,-17,16,49,39,102,63,103,-10,42,45,-32,37,123,-101,-81,-83,-97,96,95,116,63,-95,-19,62,44,115,-32,114,89,47,32,-61,80,29,0,46,-22,-66,84,-118,20,20,-26,-36,94,28,-112,-17,-6,-41,26,120,8,6,-90,37,38,-128,37,10,59,33,-18,-113,95,-106,-97,104,-38,39,9,-94,-79,-120,-111,6,7,26,30,45,41,-19,-128,61,-43,-95,-98,72,100,-5,89,-11,90,100,106,67,-8,-87,-96,-83,-82,-1,-59,69,-42,-91,90,111,83,-7,43,-30,-20,-67,-22,93,-124,-52,75,110,43,75,10,-124,37,-114,4,-90,106,100,66,17,-47,-108,43,53,109,-126,-99,9,97,-78,-43,-31,-83,123,112,79,-24,0,18,98,-46,97,-98,-37,49,-72,114,73,-56,-85,-38,-48,-76,-118,123,-63,-120,-24,-109,-100,62,15,-81,50,-61,-41,-38,81,39,-75,116,-71,69,68,-124,-16,-2,28,-12,7,123,-97,-50,-104,2,27,38,-103,-58,29,74,-39,-42,-10,56,86,-99,-87,-7,-9,-34,82,-122,124,-99,-12,-79,71,31,-15,50,-60,-89,-125,-31,-20,-107,71,-128,-104,-29,58,107,-78,-76,31,-91,26,8,43,-120,-22,-107,49,-45,-30,-64,-37,-30,-24,119,34,69,121,86,-19,-128,-99,120,83,104,-114,5,-120,124,-69,123,71,-24,32,36,81,-46,79,66,86,-53,9,0,-76,55,51,-74,9,28,-4,91,40,-101,21,115,-94,-4,120,-115,-28,-15,36,56,103,-44,-14,104,10,-53,-83,49,83,18,-62,92,15,-67,89,-42,41,-25,-105,-112,31,0,-71,-21,-59,-30,-23,-56,-37,80,-8,19,-24,-96,-28,16,14,-117,-48,84,96,2,-70,-2,-13,102,-11,-59,-40,51,-40,-36,28,-120,70,46,93,-115,-70,16,-117,-68,37,-76,21,-46,-94,-106,112,-103,9,-64,115,95,18,67,-80,-127,55,-83,-99,-8,120,-44,-17,14,14,-103,-30,30,125,-16,-122,-106,119,110,-19,-85,21,-39,-94,-12,60,14,-59,120,-62,-96,40,24,51,120,-87,-125,-33,70,-44,21,106,31,122,-10,76,-64,117,33,6,62,-38,89,62,49,-36,18,44,-58,70,-25,126,34,42,-102,-68,-86,15,40,-5,125,-42,77,-16,101,62,-39,105,-30,92,-93,114,12,-25,-105,-12,125,109,106,-38,45,124,-116,25,18,124,-13,25,-23,7,-119,69,-50,-2,37,32,0,-64,21,68,18,-90,-15,-94,-121,26,121,91,-128,82,-68,-124,96,-77,52,-11,-77,-74,-124,2,-63,85,-43,125,-35,-63,-97,-127,32,-109,25,121,3,-98,-127,46,-14,82,21,-61,-83,6,21,-121,-99,77,-60,-4,122,97,50,-11,21,-68,-98,-24,-73,85,-87,56,-122,-71,13,-74,-87,-5,-63,70,-51,-77,18,42,93,-73,-26,6,-39,70,55,66,-5,78,83,-51,80,37,-98,-121,-98,-55,-113,-58,-25,57,-9,88,-104,80,19,90,-37,50,-62,-2,26,-34,-31,-53,-99,106,-94,-51,126,-44,32,40,-99,-128,6,64,29,-39,-64,125,125,116,-126,4,-106,34,-95,103,75,35,30,-103,110,103,-117,123,38,-76,51,-2,-51,-34,124,32,-19,58,-83,33,113,18,-9,27,37,-33,-9,118,66,-42,114,-104,-34,84,10,126,-50,-88,126,69,40,99,69,75,-60,-87,-122,-14,-32,-66,22,-3,21,69,103,-12,-88,23,112,6,34,41,-13,-25,-21,-96,3,-24,-28,100,-51,92,-46,-16,-18,97,-48,99,-9,74,98,10,-127,86,-125,-56,67,23,30,8,94,117,79,-76,0,-90,-17,-117,0,-24,-107,28,-45,-8,96,4,121,-121,80,-25,29,61,-10,86,95,102,117,-43,43,7,-57,-44,114,41,-55,-95,24,108,-31,23,-43,-89,96,119,-77,1,26,40,-117,103,-110,123,-118,-116,73,77,-60,-66,5,92,91,11,93,-60,67,8,-30,-73,42,107,34,-71,-29,-45,96,33,-82,93,-100,73,-72,-92,63,25,-63,-25,-7,-97,79,-49,-87,11,-98,-82,-98,-29,121,83,-65,-68,8,39,26,-92,-104,24,127,48,62,34,-47,120,-81,-88,89,-3,-57,-3,-101,-33,-73,121,-116,-3,122,31,-128,24,85,-33,44,112,116,-28,1,-97,-88,-24,-36,-75,51,11,-127,-28,79,-98,16,-48,-63,71,67,-33,63,-21,29,106,-122,105,-108,-40,-119,30,-59,-37,-113,36,-4,-14,-38,-55,-106,117,20,-9,-121,11,103,-5,120,-55,-22,-126,126,-70,-33,-51,-48,-60,-90,-15,60,-14,-80,-85,-54,-15,-81,115,35,14,91,0,-79,-117,-52,-65,58,-12,32,84,121,100,91,100,-45,65,-20,-118,15,83,29,-76,-11,92,102,-53,18,64,-64,116,-22,-40,26,-107,104,-64,6,-77,21,-87,-77,-40,116,-68,-23,-126,-99,-109,124,90,-3,-17,-16,115,-68,116,68,-97,74,106,105,55,96,68,-68,58,-116,0,-10,56,42,-74,-126,3,-126,112,-106,-37,78,91,-55,-104,125,16,-76,-2,2,-5,-65,73,27,-83,72,35,-111,22,47,-15,-124,-88,75,-111,-7,54,96,-42,-37,35,-6,-35,-100,92,-111,-38,-30,-51,-8,-105,-14,-48,76,62,-19,-90,-125,5,-47,-97,-49,-92,54,-85,-47,-62,-5,-127,10,-10,-33,-77,-88,31,-84,109,119,7,-1,39,100,52,-56,115,-38,46,14,-48,58,-116,30,52,44,-124,119,-106,-108,21,26,103,-8,77,-6,63,-28,-68,-92,84,-109,-113,120,-88,-116,85,-12,94,-27,-94,-120,-98,37,-77,-56,-104,-125,52,-10,-122,11,7,20,-29,9,-28,-32,-24,86,84,-67,-25,19,-25,76,98,77,-28,84,-25,-3,-72,-67,-66,-89,67,64,-114,36,36,-41,85,-107,-19,-41,60,-77,-98,93,-115,60,-119,2,-106,32,-27,68,-109,30,-80,-115,-3,89,119,82,104,25,-35,70,67,-86,-73,32,-66,58,118,124,10,39,-80,-128,71,10,-19,-65,111,-95,-15,-100,13,-31,42,-125,35,-63,-56,50,-27,80,-107,102,60,-90,-78,125,-31,-19,-33,7,7,120,89,118,-67,23,-40,51,-124,-125,-52,-118,-123,-88,31,60,85,112,-9,-29,-45,22,-41,-81,93,-71,80,64,70,-100,-123,32,20,66,-110,52,-65,-117,38,-50,-7,78,127,0,91,-122,121,56,-14,18,59,-107,68,-121,82,-45,80,50,19,-16,-88,97,98,1,-1,18,82,-72,41,-62,-21,-78,58,-105,-57,108,-73,-53,20,67,-16,86,49,-55,-31,-70,-92,95,73,59,-57,-33,-78,-111,-39,-16,-44,-25,50,29,-117,82,63,99,-9,-64,-55,-125,103,28,76,51,-37,-68,-103,30,26,-71,-57,55,29,42,30,75,-122,4,-29,-96,-48,28,80,-115,85,113,-19,-87,-53,0,50,-87,-61,1,-13,-24,111,83,45,107,78,-124,-29,110,17,100,81,-122,17,-85,-88,114,-92,79,13,-65,-99]";
			String s ="A>!GGZA3blAíxPPRA>!-A5eFFlAíx8A6EE~-A5ÉaAyKKÓ8A6ánA9uuÉaAyéIÓX::ánA9QAÉ0vvéIAXiAáDccQff0#AézjjiA}D1AYmTT#AÚzCAJM221AYmSAdqggCAJMLANwýýSAdqrAVÑ;;LANwŒAo@HHrAVÑšAhUUOŒAopWA_44¿šAhtƒOk77pWA_<%¿sññtƒAk3ApBAA<%As>AtGZZ3bbBíA<PRR>A!G5AeFllíAxP6AE~--5AeFyAKÓ886AE~9AuÉaayAKÓXA:ánn9AuÉ0AvéIIXA:}DAcQQf0AvÚzAjii}DAcYmfT##ÚzAjJM";
			String k = "A}211YmATdAÚgCCJMA2NAYýSSdqqgVAJ;LLNAwýoA@HrrVAÑ;hAUOŒŒoA@H_A4¿ššhAUOkA7pWW_A4¿sAñtƒƒkA7pBAA<%%sAñ!GAZ33bBAAxPAR>>!GAZeFblííxPAREA!-55eFAlKAx866E~A-uAeayyKÓÓ8:Aán99uAÉavAéIXX:AáncAQf00vAéIjAi}DDcAQfTA#ÚzzjAi}2A1YmmTA#ÚgACJMM2A1wýASddqgACÑ;ALNNwýAS@HqrVVÑ;ALUAwŒoo@HAr4AÑšhhUOOŒ7A@W__4¿¿šñAtƒkk7ApWAA<%ssñAtƒZA3bBBAA<%R";
			AESDTO aes = new AESDTO();
			aes.setBitsEncrypt(128+"").setIteration(636+"").setSecretKeyAES(k).setSaltAES(s);
			
			AESToUse a = new AESToUse(aes);

			//UtilsString us = new UtilsString();
			
			byte[] d = a.getAESDecryptData( g.fromJson(pk,byte[].class));
			//Usuario u = r.findById(155998L).get();
			
	        KeyFactory kf3 = KeyFactory.getInstance("RSA");
	        PKCS8EncodedKeySpec spec3 = new PKCS8EncodedKeySpec(
	                d);
	        PrivateKey privateKeyPrivacity = kf3.generatePrivate(spec3);
	        System.out.println(privateKeyPrivacity.toString());
	        
//			System.out.println( new String(d, "UTF-8"));
			
		///	System.out.println( u.getEncryptKeys().getPrivateKey());
			System.out.println("fin");
		} catch (Exception e) {
			// TODO Auto-generated catch block
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
	}
}


